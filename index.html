<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OBSERVA+ | Observaci√≥n Preventiva</title>
  <style>
    :root{
      --bg:#f6f8fb; --card:#ffffff; --primary:#1f6f5c; --secondary:#f2a365; --accent:#0b3c5d; --ok:#2ecc71; --warn:#f1c40f; --bad:#e74c3c; --text:#1f2937;
    }
    body { font-family: 'Segoe UI', Arial, sans-serif; background:var(--bg); margin:0; color:var(--text); }
    .splash { background:linear-gradient(135deg,var(--accent),var(--primary)); color:white; padding:40px 20px; text-align:center; min-height:80vh; display:flex; flex-direction:column; align-items:center; justify-content:center; }
    .splash h1{margin:0; font-size:3em; display:flex; align-items:center; justify-content:center; gap:15px;}
    .splash .shield{width:50px; height:50px}
    .splash p{margin:10px 0 30px; opacity:0.9; font-size:1.1em}
    .splash .card-info { background:rgba(255,255,255,0.15); border-radius:15px; padding:25px; max-width:500px; margin:20px 0; backdrop-filter:blur(10px); }
    .splash button { background:white; color:var(--primary); font-weight:700; padding:14px 28px; border:none; border-radius:50px; cursor:pointer; font-size:1.1em; margin-top:20px; }
    .splash button:hover { filter:brightness(0.9); }
    header { background:linear-gradient(135deg,var(--accent),var(--primary)); color:white; padding:18px; text-align:center; }
    header .brand{display:flex; align-items:center; justify-content:center; gap:10px}
    header .shield{width:34px; height:34px}
    main { padding:20px; max-width:980px; margin:auto; display:none; }
    main.active { display:block; }
    .card { background:var(--card); border-radius:14px; padding:18px; margin-bottom:16px; box-shadow:0 10px 20px rgba(0,0,0,0.08); }
    h2{margin-top:0}
    label { display:block; margin-top:12px; font-weight:600; }
    input, select, textarea, button {
      width:100%; padding:10px; margin-top:6px; border-radius:10px; border:1px solid #d1d5db; font-size:14px; box-sizing:border-box;
    }
    select[multiple]{height:110px}
    button { background:linear-gradient(135deg,var(--primary),var(--secondary)); color:white; font-weight:700; cursor:pointer; border:none; }
    button.secondary{background:#eef2f7; color:#111827}
    button:hover { filter:brightness(0.95); }
    .note { font-size:12px; color:#6b7280; margin-top:6px; }
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    .badge{display:inline-block; padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700}
    .badge.ok{background:#eafaf1; color:#166534}
    .badge.warn{background:#fff7ed; color:#9a3412}
    .badge.bad{background:#fee2e2; color:#7f1d1d}
    footer { text-align:center; font-size:12px; color:#6b7280; margin:28px 0; }
    .hidden{display:none}
  </style>
</head>
<body>

<div class="splash" id="splash">
  <svg class="shield" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L20 6V11C20 16.25 16.5 20.74 12 22C7.5 20.74 4 16.25 4 11V6L12 2Z" fill="#ffffff" opacity="0.95"/></svg>
  <h1>OBSERVA+</h1>
  <p>Observaci√≥n y Prevenci√≥n Operativa</p>
  <div class="card-info">
    <p style="margin-top:0">App progresiva para monitoreo y observaci√≥n en tiempo real</p>
    <p>Instalada desde GitHub Pages</p>
    <p style="font-size:0.9em; opacity:0.9">Es una PWA (Progressive Web App) que puedes instalar como app en tu dispositivo y usar sin conexi√≥n a internet.</p>
  </div>
  <button onclick="iniciarApp()">Comenzar ‚Üí</button>
</div>

<header id="header" class="hidden">
  <div class="brand">
    <svg class="shield" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L20 6V11C20 16.25 16.5 20.74 12 22C7.5 20.74 4 16.25 4 11V6L12 2Z" fill="#ffffff" opacity="0.95"/></svg>
    <div>
      <h1 style="margin:0">OBSERVA+</h1>
      <p style="margin:0;opacity:.9">Observaci√≥n y Prevenci√≥n Operativa</p>
    </div>
  </div>
</header>

<main id="main">

  <div class="card">
    <h2>Nuevo Reporte</h2>

    <div class="grid">
      <div>
        <label>Edificio</label>
        <select id="edificio">
          <option>Seleccione‚Ä¶</option>
          <option>Edificio 1</option>
          <option>Edificio 2</option>
          <option>Edificio 3</option>
          <option>Edificio 4</option>
        </select>
      </div>
      <div>
        <label>Lugar espec√≠fico</label>
        <input type="text" placeholder="Ej: Pasillo t√©cnico, laboratorio, acceso" />
      </div>
            <div>
        <label>Fecha (dd-mm-aaaa)</label>
        <input type="date" id="fecha" required />
      </div>
    </div>

    <label>Tipo de novedad</label>
    <select id="tipo" onchange="toggleInfra()">
      <option>Seleccione‚Ä¶</option>
      <option>Conducta insegura</option>
      <option>Desviaci√≥n de procedimiento</option>
      <option>Riesgo humano / fatiga</option>
      <option>Riesgo operativo</option>
      <option>Anomal√≠a de rutina</option>
      <option>Da√±o en infraestructura</option>
    </select>

    <div id="infra" class="hidden">
      <label>Tipo de da√±o en infraestructura</label>
      <select>
        <option>Iluminaci√≥n / el√©ctrico</option>
        <option>Puertas / accesos</option>
        <option>Pisos / baldosas</option>
        <option>Humedad / filtraci√≥n</option>
        <option>Se√±alizaci√≥n</option>
        <option>Otro</option>
      </select>
    </div>

    <label>Descripci√≥n de la novedad</label>
    <textarea rows="4" placeholder="Describa de forma objetiva lo observado"></textarea>

    <label>Motivo del reporte</label>
    <select multiple>
      <option>Fuera de horario</option>
      <option>Fuera de procedimiento</option>
      <option>Permanencia inusual</option>
      <option>Zona cr√≠tica</option>
      <option>Evento repetido</option>
      <option>Condici√≥n insegura de infraestructura</option>
    </select>

    <div class="grid">
      <div>
        <label>Nivel de riesgo</label>
        <select>
          <option>üü¢ Bajo</option>
          <option>üü° Medio</option>
          <option>üî¥ Alto</option>
        </select>
      </div>
      <div>
        <label>Enviar al PAE (RRHH)</label>
        <select>
          <option>S√≠ (paetq@tqgrupo.com)</option>
          <option>No</option>
        </select>
      </div>
    </div>

    <label>Adjuntar evidencia</label>
    <input type="file" />
    <div class="note">Evite adjuntar im√°genes con rostros si no es necesario.</div>
        <button class="secondary" onclick="abrirCamara()" style="margin-top:10px;">\ud83d\udcf7 Capturar Foto/Video</button>
    <div id="cameraContainer" class="hidden" style="margin-top:15px; border-radius:10px; overflow:hidden;">
      <video id="videoStream" style="width:100%; background:#000;"></video>
      <canvas id="canvas" style="display:none;"></canvas>
      <div style="margin-top:10px; display:flex; gap:10px;">
        <button onclick="capturarFoto()" style="flex:1;">\ud83d\udcf8 Capturar Foto</button>
        <button onclick="cerrarCamara()" style="flex:1; background:#ccc; color:#333;">‚úï Cerrar</button>
      </div>
    </div>

    <button onclick="sendMail()">Enviar Reporte</button>
        <button onclick="compartirWhatsApp()" style="margin-top:10px; background:#25D366; width:100%;">üì± Compartir por WhatsApp</button>
  </div>

</main>

<script>
  function iniciarApp(){
    document.getElementById('splash').classList.add('hidden');
    document.getElementById('header').classList.remove('hidden');
    document.getElementById('main').classList.add('active');
  }
  function toggleInfra(){
    const t = document.getElementById('tipo').value;
    document.getElementById('infra').classList.toggle('hidden', t !== 'Da√±o en infraestructura');
  }
  function sendMail(){
    window.location.href='mailto:paetq@tqgrupo.com?subject=Reporte%20Preventivo%20OBSERVA%2B&body=Se%20ha%20generado%20un%20reporte%20preventivo%20desde%20OBSERVA%2B.%0A%0AFavor%20revisar%20la%20informaci%C3%B3n%20del%20formulario%20adjunto.';
  }
  let stream = null;
  function abrirCamara(){
    const cameraContainer = document.getElementById('cameraContainer');
    const video = document.getElementById('videoStream');
    cameraContainer.classList.remove('hidden');
    navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' }, audio: false })
      .then(s => { stream = s; video.srcObject = s; video.play(); })
      .catch(e => alert('No se pudo acceder a la camara: ' + e.message));
  }
  function capturarFoto(){
    const canvas = document.getElementById('canvas');
    const video = document.getElementById('videoStream');
    const ctx = canvas.getContext('2d');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    ctx.drawImage(video, 0, 0);
    canvas.toBlob(blob => {
      const file = new File([blob], 'captura.jpg', { type: 'image/jpeg' });
      const dt = new DataTransfer();
      dt.items.add(file);
      document.querySelector('input[type=file]').files = dt.files;
      alert('Foto capturada y lista para enviar');
      cerrarCamara();
    });
  }
  function cerrarCamara(){
    if(stream) stream.getTracks().forEach(t => t.stop());
    document.getElementById('cameraContainer').classList.add('hidden');
  }
    function compartirWhatsApp(){
    const edificio = document.getElementById('edificio').value;
    const tipo = document.getElementById('tipo').value;
    const descripcion = document.querySelector('textarea').value;
    const mensaje = `*REPORTE OBSERVA+*\n\nEdificio: ${edificio}\nTipo: ${tipo}\nDescripcion: ${descripcion}\n\nEnviado desde OBSERVA+ - Observacion y prevenci√≥n Operativa`;
    const enlace = `https://wa.me/?text=${encodeURIComponent(mensaje)}`;
    window.open(enlace, '_blank');
  }
</script>

<footer>
  OBSERVA+ ¬∑ Uso preventivo ¬∑ No implica sanci√≥n autom√°tica
</footer>

</body>
</html>
